<!DOCTYPE html>
<html lang="ja">
<head>
    <!-- (省略) -->
</head>
<body>
    <!-- (省略) -->

    <script src="game_logic.js"></script>
    <script src="multiplayer.js"></script>
    <script>
        let resources = 100; // 初期資源量
        let userIP = '';

        function getUserIP() {
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    userIP = data.ip;
                    loadUserData();
                });
        }

        function loadUserData() {
            const users = JSON.parse(localStorage.getItem('users')) || {};
            if (users[userIP]) {
                document.querySelector('.menu').classList.remove('hidden');
                document.querySelector('.battle').classList.remove('hidden');
                document.querySelector('.research').classList.remove('hidden');
                document.querySelector('.email').classList.remove('hidden');
                document.querySelector('.status').classList.remove('hidden');
            } else {
                users[userIP] = { /* user data structure */ };
                localStorage.setItem('users', JSON.stringify(users));
                document.querySelector('.menu').classList.remove('hidden');
                document.querySelector('.battle').classList.remove('hidden');
                document.querySelector('.research').classList.remove('hidden');
                document.querySelector('.email').classList.remove('hidden');
                document.querySelector('.status').classList.remove('hidden');
            }
        }

        function requestAdminAccess() {
            const password = prompt("パスワードを入力してください:");
            if (password === 'ゔぃぎゃん') {
                alert("管理者メニューが表示されます。");
                document.querySelector('.menu').classList.remove('hidden');
                document.querySelector('.battle').classList.remove('hidden');
                document.querySelector('.research').classList.remove('hidden');
                document.querySelector('.email').classList.remove('hidden');
                document.querySelector('.status').classList.remove('hidden');
            } else {
                alert("パスワードが間違っています。");
            }
        }

        function logout() {
            document.querySelector('.menu').classList.add('hidden');
            document.querySelector('.battle').classList.add('hidden');
            document.querySelector('.research').classList.add('hidden');
            document.querySelector('.email').classList.add('hidden');
            document.querySelector('.status').classList.add('hidden');
        }

        getUserIP();
    </script>
</body>
</html>
